FROM openjdk:21-jdk-slim

# Maven 설치
RUN apt-get update && apt-get install -y maven && rm -rf /var/lib/apt/lists/*

WORKDIR /app
COPY . .

# 의존성 선캐시(빠른 재빌드용, 선택)
RUN mvn -q -DskipTests dependency:go-offline

# 실행: Maven exec로 메인 실행 (클래스패스 자동 해결)
CMD ["mvn","-q","-DskipTests","-Dexec.mainClass=com.chatproject.secure_chat.client.ChatClient","exec:java"]
